environment:
  EXAMPLES: console
  VERBOSE: true
  matrix:
    # 32-bit
    - RUBY_VERSION: 23
      RUST_HOST: i686-pc-windows-msvc
      RUST_VERSION: stable

install:
  - appveyor-retry appveyor DownloadFile https://win.rustup.rs/ -FileName rustup-init.exe
  - rustup-init.exe -y --default-toolchain=%RUST_VERSION% --default-host=%RUST_HOST%
  - set PATH=%PATH%;C:\Users\appveyor\.cargo\bin

  - set PATH=C:\Ruby%RUBY_VERSION%\bin;C:\Ruby%RUBY_VERSION%\DevKit\bin;C:\Ruby%RUBY_VERSION%\DevKit\mingw\bin;%APPVEYOR_BUILD_FOLDER%\ruby\windows_build;%PATH%
  - echo %PATH%
  - set HELIX_ROOT=%APPVEYOR_BUILD_FOLDER%

test_script:
  - ruby bar.rb
  - rustc lib.rs --crate-type dylib -L.
  - copy lib.dll native.so
  - ruby foo.rb

build: off
